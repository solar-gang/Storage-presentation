<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Solar + Storage | Guided Presentation</title>
  <meta name="description" content="Two-mode solar + storage guided deck: Presentation Mode for customers, Learning Mode for reps, with fullscreen presenter + minimal customer view." />
  <style>
    :root{
      --bg:#070A12;
      --panel:rgba(255,255,255,.06);
      --panel2:rgba(255,255,255,.09);
      --stroke:rgba(255,255,255,.12);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.72);
      --muted2:rgba(255,255,255,.56);
      --shadow:0 24px 80px rgba(0,0,0,.55);
      --radius:18px;
      --max:1220px;

      /* Utility theme defaults (swapped via JS) */
      --utilityA:#D1202E; /* SCE primary */
      --utilityB:#FFCF36; /* SCE accent */
      --utilityShort:"SCE";

      /* Proposal theme */
      --proposalA:#60A5FA;
      --proposalB:#A78BFA;

      --good:#22C55E;
      --bad:#EF4444;

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 15% 10%, rgba(96,165,250,.22), transparent 55%),
        radial-gradient(900px 500px at 85% 15%, rgba(167,139,250,.18), transparent 55%),
        radial-gradient(1000px 650px at 50% 110%, rgba(34,197,94,.14), transparent 60%),
        linear-gradient(180deg, #050712 0%, #070A12 45%, #050712 100%);
      overflow-x:hidden;
    }

    a{ color:rgba(255,255,255,.90); text-decoration:none; }
    a:hover{ text-decoration:underline; }

    .wrap{ max-width:var(--max); margin:0 auto; padding:16px 16px 80px; }

    /* ---------- Topbar ---------- */
    .topbar{
      position:sticky; top:12px; z-index:50;
      border:1px solid var(--stroke);
      border-radius:22px;
      background:linear-gradient(180deg, rgba(255,255,255,.085), rgba(255,255,255,.045));
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      padding:12px 12px;
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      flex-wrap:wrap;
    }

    .brand{ display:flex; gap:10px; align-items:center; }
    .mark{
      width:40px; height:40px; border-radius:14px;
      background:
        radial-gradient(circle at 25% 30%, rgba(255,255,255,.25), transparent 50%),
        linear-gradient(135deg, var(--utilityA), rgba(34,197,94,.72));
      border: 1px solid rgba(255,255,255,.16);
      box-shadow:0 18px 60px rgba(0,0,0,.45);
      position:relative;
    }
    .mark:after{
      content:"";
      position:absolute; inset:10px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.18);
      opacity:.6;
    }

    .brand h1{ margin:0; font-size:14px; letter-spacing:.25px; font-weight:750; line-height:1.1; }
    .brand p{ margin:2px 0 0; font-size:12px; color:var(--muted2); }

    .controls{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .pill{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.045);
      border-radius: 999px;
      padding: 10px 12px;
      display:flex; gap:10px; align-items:center;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.06);
    }
    select, input[type="text"], input[type="number"]{
      font:inherit;
      color:var(--text);
      background:transparent;
      border:0;
      outline:none;
    }
    select{ cursor:pointer; }

    .btn{
      cursor:pointer;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:var(--text);
      padding:10px 12px;
      border-radius:14px;
      font-weight:700;
      letter-spacing:.2px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.08);
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
      white-space:nowrap;
    }
    .btn:hover{ transform:translateY(-1px); background:rgba(255,255,255,.085); border-color:rgba(255,255,255,.22); }
    .btn:active{ transform:translateY(0); }

    /* Mode toggle */
    .toggle{
      display:flex; align-items:center; gap:0;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      border-radius:999px;
      overflow:hidden;
    }
    .toggle button{
      border:0; background:transparent; color:var(--muted);
      padding:10px 12px; cursor:pointer; font-weight:780; letter-spacing:.2px;
    }
    .toggle button.active{
      background: rgba(255,255,255,.10);
      color: rgba(255,255,255,.92);
    }

    /* ---------- Presentation Deck ---------- */
    .deck{
      margin-top:14px;
      border:1px solid var(--stroke);
      border-radius:26px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .deck-top{
      padding:12px 14px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      border-bottom:1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      flex-wrap:wrap;
    }

    .progress{
      flex: 1;
      height:10px;
      border-radius:999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      overflow:hidden;
      min-width:180px;
    }
    .bar{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, var(--utilityA), var(--utilityB));
      border-radius:999px;
      transition: width .2s ease;
    }

    .dots{ display:flex; gap:6px; align-items:center; }
    .dot{
      width:8px; height:8px; border-radius:50%;
      background: rgba(255,255,255,.22);
      border: 1px solid rgba(255,255,255,.18);
      cursor:pointer;
    }
    .dot.active{
      background: rgba(255,255,255,.85);
      border-color: rgba(255,255,255,.35);
    }

    .deck-body{ padding:18px; }

    .slide{
      display:none;
      border:1px solid rgba(255,255,255,.10);
      border-radius:22px;
      background:
        radial-gradient(420px 240px at 18% 12%, rgba(255,255,255,.10), transparent 60%),
        radial-gradient(340px 220px at 86% 18%, rgba(255,255,255,.06), transparent 60%),
        rgba(0,0,0,.18);
      padding:22px;
      min-height: 420px;
    }
    .slide.active{ display:block; }

    .slide h2{
      margin:0 0 10px;
      font-size:34px;
      letter-spacing:-.7px;
      line-height:1.06;
    }
    .slide p{
      margin:0 0 14px;
      color:var(--muted);
      font-size:16px;
      line-height:1.6;
      max-width: 80ch;
    }

    .bigline{
      margin-top:14px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      padding:14px;
      font-size:18px;
      color: rgba(255,255,255,.88);
      line-height:1.5;
    }
    .bigline strong{ color: rgba(255,255,255,.95); }

    .two-col{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-top:14px;
    }
    @media (max-width: 980px){
      .slide h2{ font-size:28px; }
      .two-col{ grid-template-columns: 1fr; }
      .slide{ min-height:unset; }
    }

    .tile{
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      padding:14px;
    }
    .tile .k{ font-size:12px; color:var(--muted2); letter-spacing:.25px; }
    .tile .v{ margin-top:6px; font-size:22px; font-weight:900; letter-spacing:-.2px; }
    .tile .h{ margin-top:6px; font-size:13px; color:var(--muted); line-height:1.5; }

    .nav{
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      margin-top:14px;
      flex-wrap:wrap;
    }
    .nav .left, .nav .right{ display:flex; gap:10px; align-items:center; }

    .kbd{
      font-family: var(--mono);
      font-size: 11px;
      color: rgba(255,255,255,.70);
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      border-radius: 10px;
      padding: 8px 10px;
      white-space:nowrap;
    }

    /* ---------- Learning Mode sections ---------- */
    .learn{
      margin-top: 14px;
      display:none;
    }
    .learn.active{ display:block; }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    @media (max-width: 980px){ .grid{ grid-template-columns: 1fr; } }

    .card{
      border:1px solid var(--stroke);
      border-radius: var(--radius);
      background: rgba(255,255,255,.05);
      box-shadow: 0 24px 80px rgba(0,0,0,.45);
      overflow:hidden;
    }
    .card-h{
      padding: 14px 14px 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    }
    .card-h h3{ margin:0; font-size:14px; letter-spacing:.25px; }
    .card-h p{ margin:6px 0 0; color:var(--muted); font-size:12.8px; line-height:1.5; }
    .card-b{ padding: 12px 14px 14px; }

    .callout{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.16);
      border-radius: 14px;
      padding: 12px;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.6;
    }
    .callout strong{ color: rgba(255,255,255,.92); }

    .src{
      margin-top:10px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.16);
      border-radius: 12px;
      padding: 10px;
      display:flex; gap:10px; justify-content:space-between; align-items:flex-start;
      color: var(--muted);
      font-size: 12.5px;
    }
    .tag{
      font-size: 11px;
      padding: 6px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.70);
      white-space:nowrap;
      background: rgba(255,255,255,.04);
    }

    /* Calculator styles */
    .calc-grid{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 12px;
      margin-top: 12px;
    }
    @media (max-width: 980px){ .calc-grid{ grid-template-columns: 1fr; } }

    .col{
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 18px;
      background: rgba(0,0,0,.16);
      padding: 12px;
      position: relative;
      overflow:hidden;
    }
    .col:before{
      content:"";
      position:absolute; inset:-60px -60px auto auto;
      width:160px; height:160px; border-radius:50%;
      opacity:.18;
    }
    .col.utility:before{ background: radial-gradient(circle at 40% 40%, var(--utilityB), transparent 65%); }
    .col.a:before{ background: radial-gradient(circle at 40% 40%, var(--proposalA), transparent 65%); }
    .col.b:before{ background: radial-gradient(circle at 40% 40%, var(--proposalB), transparent 65%); }

    .colhead{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:10px; }
    .colhead h4{ margin:0; font-size:13px; letter-spacing:.2px; }
    .chip{
      font-size: 11px;
      padding: 6px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      color: rgba(255,255,255,.80);
      white-space:nowrap;
    }

    .form{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .field{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      border-radius:14px;
      padding:10px;
    }
    .field.full{ grid-column:1 / -1; }
    .field label{
      display:block;
      font-size:11px;
      color:var(--muted2);
      margin-bottom:6px;
      letter-spacing:.2px;
    }
    .field input{ width:100%; font-weight:800; font-size:14px; }
    .field small{ display:block; margin-top:6px; color:var(--muted); font-size:11.5px; line-height:1.35; }

    .summary{
      margin-top:10px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      padding:10px;
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
      color:var(--muted);
      font-size:12.5px;
    }
    .big{ font-size:18px; font-weight:920; letter-spacing:-.2px; color:rgba(255,255,255,.94); }
    .good{ color: var(--good); }
    .bad{ color: var(--bad); }
    .mono{ font-family: var(--mono); }

    .tablewrap{
      margin-top:12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      overflow:hidden;
    }
    table{
      width:100%;
      border-collapse:collapse;
      font-size:12.5px;
      background: rgba(0,0,0,.16);
    }
    thead th{
      text-align:left; padding:10px;
      background: rgba(255,255,255,.05);
      border-bottom:1px solid rgba(255,255,255,.08);
      color: rgba(255,255,255,.88);
      font-weight:800;
      letter-spacing:.2px;
    }
    tbody td{
      padding:10px;
      border-bottom:1px solid rgba(255,255,255,.06);
      color: var(--muted);
    }
    tbody tr:hover td{ background: rgba(255,255,255,.03); color: rgba(255,255,255,.86); }

    .foot{
      margin-top: 14px;
      color: var(--muted2);
      font-size: 12px;
      line-height: 1.6;
      border-top: 1px solid rgba(255,255,255,.08);
      padding-top: 12px;
    }

    .hidden{ display:none !important; }

    /* Mode switching */
    body.presentation .learn{ display:none !important; }
    body.learning .deck{ display:none !important; }

    /* ---------- Minimal Customer View (Presentation calculator readability) ---------- */
    /* In minimal mode, hide non-essential calculator fields + helper text */
    body.minimal .field:not(.essential){ display:none; }
    body.minimal .field small{ display:none; }
    body.minimal .slide p.tighten{ display:none; } /* optional */
    body.minimal .calc-grid{ margin-top: 10px; }
    body.minimal .summary{
      grid-template-columns: 1fr 1fr;
    }
    /* Make headings a little tighter in minimal */
    body.minimal .slide[data-title="Compare"] h2{ margin-bottom: 6px; }
    body.minimal .slide[data-title="Compare"] p{ margin-bottom: 8px; }

    /* When fullscreen, reduce page padding for a cleaner stage */
    body.fullscreen .wrap{ padding-top: 10px; }
  </style>
</head>

<body class="presentation">
  <div class="wrap">

    <!-- Topbar -->
    <div class="topbar" id="topbar">
      <div class="brand">
        <div class="mark" aria-hidden="true"></div>
        <div>
          <h1>Solar + Storage Presentation</h1>
          <p id="subline">Presentation Mode • customer-friendly slides</p>
        </div>
      </div>

      <div class="controls">
        <div class="toggle" aria-label="Mode toggle">
          <button id="modePresentation" class="active" type="button">Presentation</button>
          <button id="modeLearning" type="button">Learning</button>
        </div>

        <button class="btn" id="presentBtn" type="button" title="Fullscreen presenter mode">Presenter Fullscreen</button>
        <button class="btn" id="minimalBtn" type="button" title="Toggle minimal customer view">Customer View: ON</button>

        <div class="pill" title="Select the customer’s utility">
          <span style="color:var(--muted2); font-size:12px; letter-spacing:.2px;">Utility</span>
          <select id="utilitySelect" aria-label="Select utility">
            <option value="sce">Southern California Edison (SCE)</option>
            <option value="pge">PG&E</option>
            <option value="sdge">SDG&E</option>
          </select>
        </div>

        <button class="btn" id="copyLinkBtn" type="button">Copy Page Link</button>
        <button class="btn" id="resetBtn" type="button">Reset Inputs</button>
      </div>
    </div>

    <!-- PRESENTATION DECK -->
    <section class="deck" id="deck" aria-label="Presentation deck">
      <div class="deck-top">
        <div class="progress" aria-label="Slide progress"><div class="bar" id="bar"></div></div>
        <div class="dots" id="dots" aria-label="Slide dots"></div>
      </div>

      <div class="deck-body">
        <!-- Slide 1 -->
        <div class="slide active" data-title="Intro">
          <h2>Store the sun. Own the night.</h2>
          <p>
            This is a simple, trust-first walkthrough: why bills rise, why 4–9pm matters, how batteries fix it,
            and a clean 25-year comparison.
          </p>
          <div class="bigline">
            <strong>Rule:</strong> If we can’t show clear value and day-one savings, we stop and adjust. Trust &gt; pressure.
          </div>
          <div class="nav">
            <div class="left">
              <span class="kbd">Tip: Use → and ← keys</span>
            </div>
            <div class="right">
              <button class="btn" data-next type="button">Next</button>
            </div>
          </div>
        </div>

        <!-- Slide 2 -->
        <div class="slide" data-title="Problem">
          <h2>The problem: electricity keeps getting more expensive</h2>
          <p>
            Utilities raise rates for grid upgrades, wildfire hardening, infrastructure, and system costs.
            Your bill is exposed to those increases every year.
          </p>
          <div class="two-col">
            <div class="tile">
              <div class="k">Customer avg bill (today)</div>
              <div class="v" id="kpiBillSlide">$—</div>
              <div class="h">Confirm the real average. (Not the best month.)</div>
            </div>
            <div class="tile">
              <div class="k">Customer effective cost</div>
              <div class="v" id="kpiCentsSlide">— ¢/kWh</div>
              <div class="h">If you add usage, we estimate ¢/kWh instantly.</div>
            </div>
          </div>
          <div class="bigline">
            <strong>Sources are built in.</strong> Switch to <strong>Learning</strong> mode to show proof links.
          </div>
          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right"><button class="btn" data-next type="button">Next</button></div>
          </div>
        </div>

        <!-- Slide 3 -->
        <div class="slide" data-title="TOU">
          <h2>Time-of-Use: the daily 4–9pm penalty</h2>
          <p>
            TOU doesn’t only care how much power you used — it cares <strong>when</strong> you used it.
            Peak hours are when families are home.
          </p>
          <div class="two-col">
            <div class="tile">
              <div class="k">Typical peak window</div>
              <div class="v">4–9pm</div>
              <div class="h">Exact times vary by plan and season.</div>
            </div>
            <div class="tile">
              <div class="k">What this causes</div>
              <div class="v">More expensive nights</div>
              <div class="h">HVAC, cooking, laundry, EV charging get hit hardest.</div>
            </div>
          </div>
          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right"><button class="btn" data-next type="button">Next</button></div>
          </div>
        </div>

        <!-- Slide 4 -->
        <div class="slide" data-title="Storage">
          <h2>Storage fixes TOU by shifting your power</h2>
          <p>
            Solar makes energy midday. Batteries let you use that energy at night — when power costs the most.
          </p>
          <div class="two-col">
            <div class="tile">
              <div class="k">Simple explanation</div>
              <div class="v">Battery = time machine</div>
              <div class="h">Store midday → use during 4–9pm.</div>
            </div>
            <div class="tile">
              <div class="k">Outcome</div>
              <div class="v">More control</div>
              <div class="h">Less dependence on peak rates.</div>
            </div>
          </div>
          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right"><button class="btn" data-next type="button">Next</button></div>
          </div>
        </div>

        <!-- Slide 5 -->
        <div class="slide" data-title="Backup">
          <h2>Backup protection: when the neighborhood goes dark</h2>
          <p>
            Even if outages aren’t frequent, the first time it happens you immediately feel the value.
          </p>
          <div class="bigline">
            <strong>Customer moment:</strong> “Fridge, lights, Wi-Fi, phones, and essentials — staying on matters.”
          </div>
          <div class="bigline" id="outageBlock">
            <strong>Optional:</strong> Add your outage demo video in Learning Mode.
          </div>
          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right"><button class="btn" data-next type="button">Next</button></div>
          </div>
        </div>

        <!-- Slide 6 -->
        <div class="slide" data-title="VPP">
          <h2>Tesla Virtual Power Plant: possible earnings</h2>
          <p>
            A VPP is when many home batteries help the grid during events. Some programs compensate exports.
            Programs vary by utility and season.
          </p>
          <div class="bigline">
            <strong>Keep it factual:</strong> “If available and you opt in, it can add extra value.”
          </div>
          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right"><button class="btn" data-next type="button">Next</button></div>
          </div>
        </div>

        <!-- Slide 7 (Calculator) -->
        <div class="slide" data-title="Compare">
          <h2>25-year comparison</h2>
          <p class="tighten">
            Agree on today’s average bill + expected annual increase. Then compare to two options.
          </p>

          <div class="calc-grid">
            <div class="col utility">
              <div class="colhead">
                <h4 id="utilityColTitle">Utility (SCE)</h4>
                <div class="chip">Baseline</div>
              </div>
              <div class="form">
                <div class="field full essential">
                  <label>Current avg monthly bill ($)</label>
                  <input id="uMonthly" type="number" min="0" step="1" placeholder="e.g., 320" />
                  <small>Confirm with homeowner.</small>
                </div>
                <div class="field essential">
                  <label>Annual increase (%)</label>
                  <input id="uEsc" type="number" min="0" step="0.1" placeholder="e.g., 6.0" />
                  <small>Agree together.</small>
                </div>
                <div class="field">
                  <label>Usage (kWh / month)</label>
                  <input id="uKwh" type="number" min="0" step="1" placeholder="e.g., 700" />
                  <small>Optional ¢/kWh estimate.</small>
                </div>
              </div>
              <div class="summary">
                <div>
                  <div style="color:var(--muted2); font-size:11px;">25-year total</div>
                  <div class="big" id="uTotal">$—</div>
                </div>
                <div>
                  <div style="color:var(--muted2); font-size:11px;">Est. rate</div>
                  <div class="big" id="uCents">— ¢/kWh</div>
                </div>
              </div>
            </div>

            <div class="col a">
              <div class="colhead">
                <h4>Option A</h4>
                <div class="chip">Proposal 1</div>
              </div>
              <div class="form">
                <div class="field full essential">
                  <label>Monthly payment ($)</label>
                  <input id="aMonthly" type="number" min="0" step="1" placeholder="e.g., 255" />
                  <small>Enter your offer.</small>
                </div>
                <div class="field">
                  <label>Annual escalator (%)</label>
                  <input id="aEsc" type="number" min="0" step="0.1" placeholder="e.g., 0.0" />
                  <small>If any.</small>
                </div>
                <div class="field">
                  <label>Notes</label>
                  <input id="aNotes" type="text" placeholder="e.g., 1x PW3, fixed payment" />
                  <small>Optional.</small>
                </div>
              </div>
              <div class="summary">
                <div>
                  <div style="color:var(--muted2); font-size:11px;">25-year total</div>
                  <div class="big" id="aTotal">$—</div>
                </div>
                <div>
                  <div style="color:var(--muted2); font-size:11px;">Savings vs utility</div>
                  <div class="big" id="aSave">$—</div>
                </div>
              </div>
            </div>

            <div class="col b">
              <div class="colhead">
                <h4>Option B</h4>
                <div class="chip">Proposal 2</div>
              </div>
              <div class="form">
                <div class="field full essential">
                  <label>Monthly payment ($)</label>
                  <input id="bMonthly" type="number" min="0" step="1" placeholder="e.g., 285" />
                  <small>Premium option.</small>
                </div>
                <div class="field">
                  <label>Annual escalator (%)</label>
                  <input id="bEsc" type="number" min="0" step="0.1" placeholder="e.g., 0.0" />
                  <small>If any.</small>
                </div>
                <div class="field">
                  <label>Notes</label>
                  <input id="bNotes" type="text" placeholder="e.g., 2x PW3, max TOU control" />
                  <small>Optional.</small>
                </div>
              </div>
              <div class="summary">
                <div>
                  <div style="color:var(--muted2); font-size:11px;">25-year total</div>
                  <div class="big" id="bTotal">$—</div>
                </div>
                <div>
                  <div style="color:var(--muted2); font-size:11px;">Savings vs utility</div>
                  <div class="big" id="bSave">$—</div>
                </div>
              </div>
            </div>
          </div>

          <div class="bigline" style="margin-top:12px;">
            <strong>Rule:</strong> No day-one savings = we stop and adjust.
          </div>

          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right"><button class="btn" data-next type="button">Next</button></div>
          </div>
        </div>

        <!-- Slide 8 (Close) -->
        <div class="slide" data-title="Close">
          <h2>Close with clarity (not pressure)</h2>
          <p>
            “By the end of today you should have enough information to make an educated decision.
            If we can’t improve your situation, we won’t move forward.”
          </p>

          <div class="two-col">
            <div class="tile">
              <div class="k">Option A</div>
              <div class="v" id="closeA">—</div>
              <div class="h" id="closeANotes">—</div>
            </div>
            <div class="tile">
              <div class="k">Option B</div>
              <div class="v" id="closeB">—</div>
              <div class="h" id="closeBNotes">—</div>
            </div>
          </div>

          <div class="bigline">
            <strong>Next steps:</strong> qualification → site survey → final design review → permitting when you sign off.
          </div>

          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right">
              <button class="btn" id="jumpToLearning" type="button">Open Learning Mode</button>
            </div>
          </div>
        </div>

      </div>
    </section>

    <!-- LEARNING MODE -->
    <section class="learn" id="learn">
      <div class="grid">

        <div class="card">
          <div class="card-h">
            <h3>Learning: Problem (rates rising)</h3>
            <p>Deeper talk track + proof links.</p>
          </div>
          <div class="card-b">
            <div class="callout">
              <strong>Talk track:</strong> “Utilities don’t sell solar. They sell electricity. When grid costs rise — infrastructure,
              wildfire hardening, maintenance — rates follow. Our job is to give you control and protection from peak pricing.”
            </div>
            <div id="problemSources"></div>
          </div>
        </div>

        <div class="card">
          <div class="card-h">
            <h3>Learning: TOU (4–9pm)</h3>
            <p>Keep it simple for customers; be precise for reps.</p>
          </div>
          <div class="card-b">
            <div class="callout">
              <strong>Talk track:</strong> “TOU doesn’t punish you for using power — it punishes you for using it at the wrong time.
              4–9pm is when families are home and the grid is stressed.”
            </div>
            <div class="callout" style="margin-top:10px;">
              <strong>Rep note:</strong> TOU periods vary by plan/season. Don’t overclaim exact rates—use the customer’s plan info if needed.
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-h">
            <h3>Learning: Storage + Backup</h3>
            <p>How to explain batteries without sounding “salesy.”</p>
          </div>
          <div class="card-b">
            <div class="callout">
              <strong>Talk track:</strong> “Solar alone helps. Solar + storage is control. It’s not just producing power —
              it’s choosing when you use your power.”
            </div>
            <div class="callout" style="margin-top:10px;">
              <strong>Optional outage video:</strong> paste a YouTube <em>embed</em> URL in the script:
              <div class="mono" style="margin-top:8px;">const OUTAGE_VIDEO_URL = "https://www.youtube.com/embed/VIDEO_ID";</div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-h">
            <h3>Learning: Tesla VPP</h3>
            <p>Programs vary by utility and season—stick to the source.</p>
          </div>
          <div class="card-b">
            <div class="callout">
              <strong>Talk track:</strong> “If available and you opt in, your battery can export during grid events. Some programs compensate exports.
              We’ll show the program page for your utility.”
            </div>
            <div id="vppSources"></div>
            <div class="callout" style="margin-top:10px;">
              <strong>Optional ‘check’ images:</strong> add your own URLs in:
              <div class="mono" style="margin-top:8px;">const VPP_CHECK_IMAGE_URLS = ["https://...", "https://..."];</div>
              <div id="checkRow" style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;"></div>
            </div>
          </div>
        </div>

        <div class="card" style="grid-column:1 / -1;">
          <div class="card-h">
            <h3>Learning: 25-year Table (verification)</h3>
            <p>Full year-by-year table for reps and math checks.</p>
          </div>
          <div class="card-b">
            <div class="callout">
              Totals are year-by-year projections using the entered escalator rate.
              Savings = Utility total − Option total.
            </div>
            <div class="tablewrap">
              <table aria-label="25-year projection table">
                <thead>
                  <tr>
                    <th style="width:70px;">Year</th>
                    <th id="thUtil">Utility</th>
                    <th>Option A</th>
                    <th>Option B</th>
                    <th>Savings A</th>
                    <th>Savings B</th>
                  </tr>
                </thead>
                <tbody id="tbody"></tbody>
              </table>
            </div>

            <div class="foot">
              <b>Disclaimer:</b> This is a sales tool, not legal/financial advice. Rates and programs change by utility, plan, and season.
            </div>
          </div>
        </div>

      </div>
    </section>

  </div>

  <script>
    /***************
      CONFIG (EDIT ME)
    ****************/
    // Optional: paste a YouTube embed URL (NOT a normal watch URL)
    // Example: https://www.youtube.com/embed/VIDEO_ID
    const OUTAGE_VIDEO_URL = "";

    // Optional: add your own VPP "check" image URLs
    const VPP_CHECK_IMAGE_URLS = [
      // "https://yourdomain.com/check1.jpg",
      // "https://yourdomain.com/check2.jpg",
    ];

    /***************
      UTILITY THEMES + SOURCES
    ****************/
    const UTILITIES = {
      sce: {
        label: "Southern California Edison (SCE)",
        short: "SCE",
        colors: { A: "#D1202E", B: "#FFCF36" },
        sources: [
          {
            title: "SCE: Understanding updates to your bill (mentions ~13% residential increase on October bills)",
            url: "https://www.sce.com/save-money/rates-financing/residential-rate-plans/understanding-updates-to-your-bill",
            tag: "Primary source"
          },
          {
            title: "CPUC SB-695 report: forecasts average annual bundled rate increases (context + drivers)",
            url: "https://www.cpuc.ca.gov/-/media/cpuc-website/divisions/office-of-governmental-affairs-division/reports/2025/2025-sb-695-report_093025.pdf",
            tag: "CPUC"
          },
          {
            title: "CPUC: SCE GRC proceedings (context on multi-year rate setting)",
            url: "https://www.cpuc.ca.gov/industries-and-topics/electrical-energy/electric-rates/general-rate-case/southern-california-edison-grc-proceedings",
            tag: "CPUC"
          }
        ],
        vpp: [
          {
            title: "Tesla VPP with SCE (DSGS): program overview + compensation notes",
            url: "https://www.tesla.com/support/energy/virtual-power-plant/sce",
            tag: "Tesla"
          }
        ]
      },
      pge: {
        label: "Pacific Gas & Electric (PG&E)",
        short: "PG&E",
        colors: { A: "#0071CE", B: "#FFD100" },
        sources: [
          {
            title: "CPUC SB-695 report: forecasts average annual bundled rate increases (context + drivers)",
            url: "https://www.cpuc.ca.gov/-/media/cpuc-website/divisions/office-of-governmental-affairs-division/reports/2025/2025-sb-695-report_093025.pdf",
            tag: "CPUC"
          },
          {
            title: "PG&E: General Rate Case page (context on timing + process)",
            url: "https://www.pge.com/en/regulation/general-rate-case.html",
            tag: "Utility page"
          }
        ],
        vpp: [
          {
            title: "Tesla VPP with PG&E (ELRP): program details",
            url: "https://www.tesla.com/support/energy/virtual-power-plant/pge",
            tag: "Tesla"
          }
        ]
      },
      sdge: {
        label: "San Diego Gas & Electric (SDG&E)",
        short: "SDG&E",
        colors: { A: "#00A6E7", B: "#9BE15D" },
        sources: [
          {
            title: "CPUC SB-695 report: forecasts average annual bundled rate increases (context + drivers)",
            url: "https://www.cpuc.ca.gov/-/media/cpuc-website/divisions/office-of-governmental-affairs-division/reports/2025/2025-sb-695-report_093025.pdf",
            tag: "CPUC"
          }
        ],
        vpp: [
          {
            title: "Tesla VPP (DSGS): California overview",
            url: "https://www.tesla.com/support/energy/virtual-power-plant/dsgs",
            tag: "Tesla"
          }
        ]
      }
    };

    /***************
      HELPERS
    ****************/
    const fmt$ = (n) => isFinite(n) ? n.toLocaleString(undefined,{style:"currency",currency:"USD",maximumFractionDigits:0}) : "—";
    const fmt$2 = (n) => isFinite(n) ? n.toLocaleString(undefined,{style:"currency",currency:"USD",maximumFractionDigits:2}) : "—";

    function projectTotal(monthly, escPct, years=25){
      const r = (escPct || 0) / 100;
      let total = 0;
      const rows = [];
      for(let y=1; y<=years; y++){
        const yearCost = (monthly * 12) * Math.pow(1+r, y-1);
        total += yearCost;
        rows.push({ y, yearCost });
      }
      return { total, rows };
    }

    function computeSavingsRows(utilRows, aRows, bRows){
      return utilRows.map((u, i) => {
        const a = aRows[i]?.yearCost ?? 0;
        const b = bRows[i]?.yearCost ?? 0;
        return { y:u.y, u:u.yearCost, a, b, sa:(u.yearCost - a), sb:(u.yearCost - b) };
      });
    }

    function setRootVar(key,val){ document.documentElement.style.setProperty(key, val); }
    const el = (id) => document.getElementById(id);

    /***************
      DOM
    ****************/
    const modePresentation = el("modePresentation");
    const modeLearning = el("modeLearning");
    const subline = el("subline");
    const learn = el("learn");
    const jumpToLearning = el("jumpToLearning");

    const presentBtn = el("presentBtn");
    const minimalBtn = el("minimalBtn");
    const deck = el("deck");

    const utilitySelect = el("utilitySelect");
    const utilityColTitle = el("utilityColTitle");
    const thUtil = el("thUtil");

    const uMonthly = el("uMonthly");
    const uEsc = el("uEsc");
    const uKwh = el("uKwh");

    const aMonthly = el("aMonthly");
    const aEsc = el("aEsc");
    const aNotes = el("aNotes");

    const bMonthly = el("bMonthly");
    const bEsc = el("bEsc");
    const bNotes = el("bNotes");

    const uTotal = el("uTotal");
    const uCents = el("uCents");
    const aTotal = el("aTotal");
    const bTotal = el("bTotal");
    const aSave = el("aSave");
    const bSave = el("bSave");

    const kpiBillSlide = el("kpiBillSlide");
    const kpiCentsSlide = el("kpiCentsSlide");

    const closeA = el("closeA");
    const closeB = el("closeB");
    const closeANotes = el("closeANotes");
    const closeBNotes = el("closeBNotes");

    const problemSources = el("problemSources");
    const vppSources = el("vppSources");
    const checkRow = el("checkRow");

    const tbody = el("tbody");

    const copyLinkBtn = el("copyLinkBtn");
    const resetBtn = el("resetBtn");

    const slides = Array.from(document.querySelectorAll(".slide"));
    const bar = el("bar");
    const dots = el("dots");

    const outageBlock = el("outageBlock");

    /***************
      SOURCES RENDER
    ****************/
    function renderSources(list, container){
      container.innerHTML = "";
      list.forEach(s => {
        const div = document.createElement("div");
        div.className = "src";
        div.innerHTML = `
          <div style="max-width:78ch;">
            <a href="${s.url}" target="_blank" rel="noopener">${s.title}</a>
          </div>
          <div class="tag">${s.tag || "Source"}</div>
        `;
        container.appendChild(div);
      });
    }

    function renderChecks(){
      if (!checkRow) return;
      checkRow.innerHTML = "";
      VPP_CHECK_IMAGE_URLS.slice(0,4).forEach(url => {
        const img = document.createElement("img");
        img.src = url;
        img.alt = "VPP payment example";
        img.style.width = "220px";
        img.style.maxWidth = "100%";
        img.style.borderRadius = "14px";
        img.style.border = "1px solid rgba(255,255,255,.10)";
        img.style.background = "rgba(0,0,0,.16)";
        checkRow.appendChild(img);
      });
    }

    /***************
      CALC + TABLE
    ****************/
    function updateKPIs(){
      const m = parseFloat(uMonthly.value);
      kpiBillSlide.textContent = (isFinite(m) && m>=0) ? fmt$(m) : "$—";

      const kwh = parseFloat(uKwh.value);
      let cents = NaN;
      if (isFinite(m) && m>0 && isFinite(kwh) && kwh>0) cents = (m / kwh) * 100;

      const centsText = isFinite(cents) ? `${cents.toFixed(1)} ¢/kWh` : "— ¢/kWh";
      kpiCentsSlide.textContent = centsText;
      uCents.textContent = centsText;
    }

    function renderTable(rows){
      tbody.innerHTML = "";
      rows.forEach(r => {
        const tr = document.createElement("tr");
        const clsA = r.sa >= 0 ? "good" : "bad";
        const clsB = r.sb >= 0 ? "good" : "bad";
        tr.innerHTML = `
          <td class="mono">${r.y}</td>
          <td>${fmt$2(r.u)}</td>
          <td>${fmt$2(r.a)}</td>
          <td>${fmt$2(r.b)}</td>
          <td class="${clsA}">${fmt$2(r.sa)}</td>
          <td class="${clsB}">${fmt$2(r.sb)}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function updateClose(){
      const aM = parseFloat(aMonthly.value);
      const bM = parseFloat(bMonthly.value);

      closeA.textContent = isFinite(aM) ? `${fmt$(aM)}/mo` : "—";
      closeB.textContent = isFinite(bM) ? `${fmt$(bM)}/mo` : "—";
      closeANotes.textContent = aNotes.value?.trim() ? aNotes.value.trim() : "Add notes (battery count, fixed payment, etc.)";
      closeBNotes.textContent = bNotes.value?.trim() ? bNotes.value.trim() : "Add notes (more storage, max TOU control, etc.)";
    }

    function recalc(){
      updateKPIs();
      updateClose();

      const uM = parseFloat(uMonthly.value); const uE = parseFloat(uEsc.value);
      const aM = parseFloat(aMonthly.value); const aE = parseFloat(aEsc.value);
      const bM = parseFloat(bMonthly.value); const bE = parseFloat(bEsc.value);

      const util = projectTotal(isFinite(uM)?uM:0, isFinite(uE)?uE:0, 25);
      const optA = projectTotal(isFinite(aM)?aM:0, isFinite(aE)?aE:0, 25);
      const optB = projectTotal(isFinite(bM)?bM:0, isFinite(bE)?bE:0, 25);

      uTotal.textContent = isFinite(uM) ? fmt$(util.total) : "$—";
      aTotal.textContent = isFinite(aM) ? fmt$(optA.total) : "$—";
      bTotal.textContent = isFinite(bM) ? fmt$(optB.total) : "$—";

      const saveA = util.total - optA.total;
      const saveB = util.total - optB.total;

      aSave.textContent = (isFinite(aM) && isFinite(uM)) ? fmt$(saveA) : "$—";
      bSave.textContent = (isFinite(bM) && isFinite(uM)) ? fmt$(saveB) : "$—";

      aSave.className = "big " + ((saveA>=0) ? "good" : "bad");
      bSave.className = "big " + ((saveB>=0) ? "good" : "bad");

      const rows = computeSavingsRows(util.rows, optA.rows, optB.rows);
      renderTable(rows);
    }

    /***************
      UTILITY SWITCH
    ****************/
    function applyUtility(key){
      const u = UTILITIES[key] || UTILITIES.sce;
      setRootVar("--utilityA", u.colors.A);
      setRootVar("--utilityB", u.colors.B);
      setRootVar("--utilityShort", `"${u.short}"`);

      utilityColTitle.textContent = `Utility (${u.short})`;
      thUtil.textContent = `Utility (${u.short})`;

      renderSources(u.sources, problemSources);
      renderSources(u.vpp, vppSources);
      renderChecks();

      outageBlock.textContent = OUTAGE_VIDEO_URL
        ? "Outage demo video is configured (great for this slide)."
        : "Optional: add your outage demo video in Learning Mode.";

      recalc();
      updateDeckUI();
    }

    /***************
      SLIDE NAV
    ****************/
    let idx = 0;

    function buildDots(){
      dots.innerHTML = "";
      slides.forEach((s, i) => {
        const d = document.createElement("div");
        d.className = "dot" + (i===idx ? " active" : "");
        d.title = s.dataset.title || `Slide ${i+1}`;
        d.addEventListener("click", () => go(i));
        dots.appendChild(d);
      });
    }

    function updateDeckUI(){
      slides.forEach((s,i)=> s.classList.toggle("active", i===idx));
      const pct = ((idx+1)/slides.length)*100;
      bar.style.width = pct + "%";
      Array.from(dots.children).forEach((d,i)=> d.classList.toggle("active", i===idx));
    }

    function go(i){
      idx = Math.max(0, Math.min(slides.length-1, i));
      updateDeckUI();
      deck?.scrollIntoView({behavior:"smooth", block:"start"});
    }
    function next(){ go(idx+1); }
    function prev(){ go(idx-1); }

    document.addEventListener("click", (e) => {
      const t = e.target;
      if (t && t.matches("[data-next]")) next();
      if (t && t.matches("[data-prev]")) prev();
    });

    document.addEventListener("keydown", (e) => {
      if (document.body.classList.contains("presentation")){
        if (e.key === "ArrowRight") next();
        if (e.key === "ArrowLeft") prev();
        if (e.key.toLowerCase() === "f") toggleFullscreen(); // quick hotkey
      }
    });

    /***************
      MODE TOGGLE
    ****************/
    function setMode(mode){
      if (mode === "learning"){
        document.body.classList.remove("presentation");
        document.body.classList.add("learning");
        learn.classList.add("active");
        modeLearning.classList.add("active");
        modePresentation.classList.remove("active");
        subline.textContent = "Learning Mode • rep notes + sources + verification table";
        window.scrollTo({top:0, behavior:"smooth"});
      } else {
        document.body.classList.add("presentation");
        document.body.classList.remove("learning");
        learn.classList.remove("active");
        modePresentation.classList.add("active");
        modeLearning.classList.remove("active");
        subline.textContent = "Presentation Mode • customer-friendly slides";
        window.scrollTo({top:0, behavior:"smooth"});
      }
    }

    modePresentation.addEventListener("click", ()=> setMode("presentation"));
    modeLearning.addEventListener("click", ()=> setMode("learning"));
    jumpToLearning?.addEventListener("click", ()=> setMode("learning"));

    /***************
      MINIMAL CUSTOMER VIEW
    ****************/
    // Default ON (as requested)
    function setMinimal(on){
      document.body.classList.toggle("minimal", !!on);
      minimalBtn.textContent = on ? "Customer View: ON" : "Customer View: OFF";
    }
    minimalBtn.addEventListener("click", ()=> {
      const isOn = document.body.classList.contains("minimal");
      setMinimal(!isOn);
    });

    /***************
      FULLSCREEN PRESENTER
    ****************/
    async function toggleFullscreen(){
      try{
        if (!document.fullscreenElement){
          await (deck || document.documentElement).requestFullscreen();
        } else {
          await document.exitFullscreen();
        }
      }catch(e){
        alert("Fullscreen isn't available on this device/browser. Try Safari/Chrome or use Landscape mode.");
      }
    }

    presentBtn.addEventListener("click", toggleFullscreen);

    document.addEventListener("fullscreenchange", () => {
      const on = !!document.fullscreenElement;
      document.body.classList.toggle("fullscreen", on);
      presentBtn.textContent = on ? "Exit Fullscreen" : "Presenter Fullscreen";
    });

    /***************
      ACTIONS
    ****************/
    function resetInputs(){
      uMonthly.value = ""; uEsc.value = ""; uKwh.value = "";
      aMonthly.value = ""; aEsc.value = ""; aNotes.value = "";
      bMonthly.value = ""; bEsc.value = ""; bNotes.value = "";
      recalc();
    }

    copyLinkBtn.addEventListener("click", async () => {
      try{
        await navigator.clipboard.writeText(window.location.href);
        copyLinkBtn.textContent = "Copied!";
        setTimeout(()=> copyLinkBtn.textContent = "Copy Page Link", 900);
      }catch(e){
        alert("Could not copy automatically. Please copy the URL from the address bar.");
      }
    });

    resetBtn.addEventListener("click", resetInputs);

    [uMonthly,uEsc,uKwh,aMonthly,aEsc,aNotes,bMonthly,bEsc,bNotes].forEach(inp => {
      inp.addEventListener("input", recalc);
    });

    utilitySelect.addEventListener("change", () => applyUtility(utilitySelect.value));

    /***************
      INIT
    ****************/
    buildDots();
    applyUtility("sce");
    recalc();
    updateDeckUI();
    setMode("presentation");
    setMinimal(true);
  </script>
</body>
</html>
